# โค้ดที่ป้องกันการล็อกเงินไว้ใน Contract
เพื่อป้องกันกรณีที่เงินถูกล็อกไว้ใน Contract โดยที่ไม่มีทางนำออกได้ โค้ดมีการใช้กลไกดังนี้:

SingleplayTimeOut()

ใช้ในกรณีที่มีผู้เล่นคนเดียวแต่ไม่มีคู่แข่งเข้ามาร่วมเล่นภายใน TIMEOUT (3 นาที)
หากเลยเวลาแล้ว ผู้เล่นคนเดิมสามารถเรียกฟังก์ชันนี้เพื่อรับเงินคืน
MultiPlayTimeOut()

ใช้ในกรณีที่มีผู้เล่น 2 คน แต่ไม่มีคนใดคนหนึ่งทำการ revealChoice() ภายใน TIMEOUT
หากมีผู้เล่นที่ไม่เปิดเผยค่าเลือกของตนภายในเวลาที่กำหนด ผู้เล่นที่เปิดเผยค่าของตัวเองจะได้รับเงินรางวัลแทน
ป้องกันกรณีที่ผู้เล่นพยายามล็อกเกมโดยไม่ยอมเปิดเผยค่าเลือกของตนเอง
# โค้ดส่วนที่ทำการซ่อน choice และ commit
โค้ดใช้กลไก Commit-Reveal Scheme เพื่อซ่อนตัวเลือกของผู้เล่นก่อนที่จะเปิดเผยทีหลัง:

getChoiceHash(uint choice, string memory secret)

สร้างค่า hash ที่ผูกกับตัวเลือก (choice) และรหัสลับ (secret) ของผู้เล่น
keccak256(abi.encodePacked(keccak256(abi.encodePacked(choice, secret))))
ใช้ hash ซ้อนกัน 2 ชั้นเพื่อให้ยากต่อการเดา
commitChoice(bytes32 commitHash)

ผู้เล่นส่งค่า hash ที่ได้จาก getChoiceHash() เพื่อเป็นหลักฐานว่าเลือกอะไรไปแล้ว โดยยังไม่เปิดเผยค่าจริง
บันทึกค่า hash ลงใน commitments[msg.sender]
กำหนดค่า hasCommitted[msg.sender] = true; เพื่อบันทึกว่าผู้เล่นได้ทำการ commit แล้ว
สิ่งนี้ช่วยป้องกันไม่ให้ผู้เล่นคนหนึ่งเห็นตัวเลือกของอีกฝ่ายก่อนแล้วเลือกตัวเลือกที่ชนะได้ง่าย ๆ
